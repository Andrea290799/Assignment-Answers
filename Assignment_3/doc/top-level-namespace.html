<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Top Level Namespace
  
    &mdash; Documentation by YARD 0.9.26
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" />

  <link rel="stylesheet" href="css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index</a> &raquo;
    
    
    <span class="title">Top Level Namespace</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Top Level Namespace
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  

  
</div>

<h2>Defined Under Namespace</h2>
<p class="children">
  
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="Gene.html" title="Gene (class)">Gene</a></span>
    
  
</p>







  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#add_features-instance_method" title="#add_features (instance method)">#<strong>add_features</strong>(positions_list, strand, entry)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This function adds some features to the Bio::Sequence sequence.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#check_format-instance_method" title="#check_format (instance method)">#<strong>check_format</strong>(file, identifier)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This function checks whether the given file has the correct format.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#generate_complete_position_list-instance_method" title="#generate_complete_position_list (instance method)">#<strong>generate_complete_position_list</strong>(incomplete_position_list, exon_pos)  &#x21d2; list </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This function generates a list of gene coordinates given a list with the initial  positions of a motif, in exon coordinates.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#get_positions_motifs-instance_method" title="#get_positions_motifs (instance method)">#<strong>get_positions_motifs</strong>(entry, gene_id)  &#x21d2; list </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This function gets the starting and ending positions of the exons in the + and - strands of the sequence.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#help-instance_method" title="#help (instance method)">#<strong>help</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This function print a help message if needed.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="top-level-namespace.html#write_to_GFF3-instance_method" title="#write_to_GFF3 (instance method)">#<strong>write_to_GFF3</strong>(first_entry, entry, gene_name)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This function writes the features in the gff3 files.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="add_features-instance_method">
  
    #<strong>add_features</strong>(positions_list, strand, entry)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>This function adds some features to the Bio::Sequence sequence</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>positions_list</span>
      
      
        <span class='type'>(<tt>list</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>coordinates of the motif in the + or - strand.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>strand</span>
      
      
        <span class='type'>(<tt>string</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>strand</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>entry</span>
      
      
        <span class='type'>(<tt>Bio::Sequence</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>sequence</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '.\Functions.rb', line 143</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_features'>add_features</span><span class='lparen'>(</span><span class='id identifier rubyid_positions_list'>positions_list</span><span class='comma'>,</span> <span class='id identifier rubyid_strand'>strand</span><span class='comma'>,</span> <span class='id identifier rubyid_entry'>entry</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_repeats'>repeats</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='comment'>#for repeated positions
</span>
    <span class='id identifier rubyid_positions_list'>positions_list</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_exon'>exon</span><span class='op'>|</span>

        <span class='kw'>unless</span> <span class='id identifier rubyid_exon'>exon</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

            <span class='id identifier rubyid_exon'>exon</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_motif'>motif</span><span class='op'>|</span>

                <span class='comment'>#to avoid repeated positions
</span>                <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_repeats'>repeats</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_motif'>motif</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='rparen'>)</span>

                    <span class='id identifier rubyid_f1'>f1</span> <span class='op'>=</span> <span class='const'>Bio</span><span class='op'>::</span><span class='const'>Feature</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>motif</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_motif'>motif</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>..</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_motif'>motif</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
                    <span class='id identifier rubyid_f1'>f1</span><span class='period'>.</span><span class='id identifier rubyid_append'>append</span><span class='lparen'>(</span><span class='const'>Bio</span><span class='op'>::</span><span class='const'>Feature</span><span class='op'>::</span><span class='const'>Qualifier</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>repeat_motif</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>CTTCTT</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
                    <span class='id identifier rubyid_f1'>f1</span><span class='period'>.</span><span class='id identifier rubyid_append'>append</span><span class='lparen'>(</span><span class='const'>Bio</span><span class='op'>::</span><span class='const'>Feature</span><span class='op'>::</span><span class='const'>Qualifier</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>strand</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_strand'>strand</span><span class='rparen'>)</span><span class='rparen'>)</span>
                    <span class='id identifier rubyid_entry'>entry</span><span class='period'>.</span><span class='id identifier rubyid_features'>features</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_f1'>f1</span>

                <span class='kw'>end</span>

                <span class='id identifier rubyid_repeats'>repeats</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_motif'>motif</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>

            <span class='kw'>end</span>

        <span class='kw'>end</span>
    
    <span class='kw'>end</span>

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="check_format-instance_method">
  
    #<strong>check_format</strong>(file, identifier)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>This function checks whether the given file has the correct format.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>file</span>
      
      
        <span class='type'>(<tt>string</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>input file</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>identifier</span>
      
      
        <span class='type'>(<tt>string</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>regular expression to search in the file. It must be between &#39;/&#39;.</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '.\Functions.rb', line 23</span>

<span class='kw'>def</span> <span class='id identifier rubyid_check_format'>check_format</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='comma'>,</span> <span class='id identifier rubyid_identifier'>identifier</span><span class='rparen'>)</span>
    
    <span class='kw'>if</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_file?'>file?</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='kw'>true</span>
    
        <span class='id identifier rubyid_lines_gene'>lines_gene</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_readlines'>readlines</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='rparen'>)</span>
                
        <span class='id identifier rubyid_match'>match</span> <span class='op'>=</span> <span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_identifier'>identifier</span><span class='rparen'>)</span> 
                
        <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_match'>match</span><span class='period'>.</span><span class='id identifier rubyid_match'>match</span><span class='lparen'>(</span><span class='id identifier rubyid_lines_gene'>lines_gene</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='rparen'>)</span>

            <span class='id identifier rubyid_abort'>abort</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\e[1;31mSorry, the </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_file'>file</span><span class='embexpr_end'>}</span><span class='tstring_content'> file has not the correct format.\e[m</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

        <span class='kw'>end</span>
           
    <span class='kw'>else</span> 

        <span class='id identifier rubyid_abort'>abort</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\e[1;31mSorry, the </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_file'>file</span><span class='embexpr_end'>}</span><span class='tstring_content'> file does not exist.\e[m</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="generate_complete_position_list-instance_method">
  
    #<strong>generate_complete_position_list</strong>(incomplete_position_list, exon_pos)  &#x21d2; <tt>list</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>This function generates a list of gene coordinates given a list with the initial  positions of a motif, in exon coordinates.  positions of the exon where we are searching the motif (to convert to gene coordinates).</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>incomplete_position_list</span>
      
      
        <span class='type'>(<tt>list</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>list with the initial position of a motif</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>exon_pos</span>
      
      
        <span class='type'>(<tt>MatchData</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>regex match object that contains the start and end</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>list</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>list of gene coordinates of the motif</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '.\Functions.rb', line 51</span>

<span class='kw'>def</span> <span class='id identifier rubyid_generate_complete_position_list'>generate_complete_position_list</span><span class='lparen'>(</span><span class='id identifier rubyid_incomplete_position_list'>incomplete_position_list</span><span class='comma'>,</span> <span class='id identifier rubyid_exon_pos'>exon_pos</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_complete_position_list'>complete_position_list</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

    <span class='kw'>unless</span> <span class='id identifier rubyid_incomplete_position_list'>incomplete_position_list</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
        
        <span class='comment'>#for each initial position
</span>        <span class='id identifier rubyid_incomplete_position_list'>incomplete_position_list</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ini'>ini</span><span class='op'>|</span> 

            <span class='id identifier rubyid_motif'>motif</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
            <span class='comment'>#convert to gene coordinates
</span>            <span class='id identifier rubyid_motif'>motif</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_ini'>ini</span> <span class='op'>+</span> <span class='id identifier rubyid_exon_pos'>exon_pos</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span> 
            <span class='id identifier rubyid_motif'>motif</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_ini'>ini</span> <span class='op'>+</span> <span class='id identifier rubyid_exon_pos'>exon_pos</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='op'>+</span><span class='int'>5</span>

            <span class='id identifier rubyid_complete_position_list'>complete_position_list</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_motif'>motif</span>

        <span class='kw'>end</span>

        <span class='kw'>return</span> <span class='id identifier rubyid_complete_position_list'>complete_position_list</span>

    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_positions_motifs-instance_method">
  
    #<strong>get_positions_motifs</strong>(entry, gene_id)  &#x21d2; <tt>list</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>This function gets the starting and ending positions of the exons in the + and - strands of the sequence. Then searches for a motif in the exon sequence and gets the gene coordinates.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>entry</span>
      
      
        <span class='type'>(<tt>Bio::EMBL</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>embl information</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>gene_id</span>
      
      
        <span class='type'>(<tt>string</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>gene name</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>list</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>list of gene coordinates of the motif in the + and - strands.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '.\Functions.rb', line 81</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_positions_motifs'>get_positions_motifs</span><span class='lparen'>(</span><span class='id identifier rubyid_entry'>entry</span><span class='comma'>,</span> <span class='id identifier rubyid_gene_id'>gene_id</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_forward_positions'>forward_positions</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='id identifier rubyid_reverse_positions'>reverse_positions</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

    <span class='id identifier rubyid_entry'>entry</span><span class='period'>.</span><span class='id identifier rubyid_features'>features</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_feature'>feature</span><span class='op'>|</span>

        <span class='comment'># we have to make sure we are getting the exons of the gene we are looking at.
</span>        <span class='comment'># for example, this gene has exons from 2 different genes
</span>        <span class='comment'># https://www.ebi.ac.uk/Tools/dbfetch/dbfetch?db=ensemblgenomesgene&amp;format=embl&amp;id=AT5g15850
</span>        <span class='kw'>if</span> <span class='id identifier rubyid_feature'>feature</span><span class='period'>.</span><span class='id identifier rubyid_feature'>feature</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>exon</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>and</span> <span class='id identifier rubyid_feature'>feature</span><span class='period'>.</span><span class='id identifier rubyid_assoc'>assoc</span><span class='lparen'>(</span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>note</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='int'>8</span><span class='op'>..</span><span class='int'>16</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_gene_id'>gene_id</span><span class='period'>.</span><span class='id identifier rubyid_upcase'>upcase</span>

            <span class='comment'># if the coordinates are like: 1..5
</span>            <span class='id identifier rubyid_re_pos_exonA'>re_pos_exonA</span> <span class='op'>=</span> <span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^(\d+)\.\.(\d+)</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span>
            <span class='comment'># if the coordinates are like: complemet(1..5)
</span>            <span class='id identifier rubyid_re_pos_exonB'>re_pos_exonB</span> <span class='op'>=</span> <span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\((\d+)\.\.(\d+)</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span>

            <span class='id identifier rubyid_positions'>positions</span> <span class='op'>=</span> <span class='id identifier rubyid_feature'>feature</span><span class='period'>.</span><span class='id identifier rubyid_position'>position</span>
            
            <span class='comment'># we first try searching for the less &quot;permissive&quot; regex
</span>            <span class='id identifier rubyid_match_pos_exon'>match_pos_exon</span> <span class='op'>=</span> <span class='id identifier rubyid_positions'>positions</span><span class='period'>.</span><span class='id identifier rubyid_match'>match</span><span class='lparen'>(</span><span class='id identifier rubyid_re_pos_exonB'>re_pos_exonB</span><span class='rparen'>)</span> 

            <span class='comment'># if there is no match...we try the other expression
</span>            <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_match_pos_exon'>match_pos_exon</span>
                <span class='id identifier rubyid_match_pos_exon'>match_pos_exon</span> <span class='op'>=</span> <span class='id identifier rubyid_positions'>positions</span><span class='period'>.</span><span class='id identifier rubyid_match'>match</span><span class='lparen'>(</span><span class='id identifier rubyid_re_pos_exonA'>re_pos_exonA</span><span class='rparen'>)</span>
            <span class='kw'>end</span>
            
            <span class='kw'>unless</span> <span class='id identifier rubyid_match_pos_exon'>match_pos_exon</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> 

                <span class='comment'># in the + strand...
</span>                <span class='id identifier rubyid_re_motif_forward'>re_motif_forward</span> <span class='op'>=</span> <span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(?=(cttctt))</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span> 
                <span class='id identifier rubyid_sequence'>sequence</span> <span class='op'>=</span> <span class='id identifier rubyid_entry'>entry</span><span class='period'>.</span><span class='id identifier rubyid_seq'>seq</span><span class='period'>.</span><span class='id identifier rubyid_subseq'>subseq</span><span class='lbracket'>[</span><span class='id identifier rubyid_match_pos_exon'>match_pos_exon</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='op'>-</span><span class='int'>1</span><span class='op'>..</span><span class='id identifier rubyid_match_pos_exon'>match_pos_exon</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span>
                <span class='id identifier rubyid_sites'>sites</span> <span class='op'>=</span> <span class='id identifier rubyid_sequence'>sequence</span><span class='period'>.</span><span class='id identifier rubyid_enum_for'>enum_for</span><span class='lparen'>(</span><span class='symbol'>:scan</span><span class='comma'>,</span> <span class='id identifier rubyid_re_motif_forward'>re_motif_forward</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_last_match'>last_match</span><span class='period'>.</span><span class='id identifier rubyid_begin'>begin</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span> <span class='rbrace'>}</span>

                <span class='comment'># we get the gene coordinates of the motif 
</span>                <span class='id identifier rubyid_a'>a</span> <span class='op'>=</span> <span class='id identifier rubyid_generate_complete_position_list'><span class='object_link'><a href="#generate_complete_position_list-instance_method" title="#generate_complete_position_list (method)">generate_complete_position_list</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_sites'>sites</span><span class='comma'>,</span> <span class='id identifier rubyid_match_pos_exon'>match_pos_exon</span><span class='rparen'>)</span>

                <span class='comment'># in the - strand...
</span>                <span class='id identifier rubyid_re_motif_reverse'>re_motif_reverse</span> <span class='op'>=</span> <span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>(?=(aagaag))</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span>
                <span class='id identifier rubyid_sites'>sites</span> <span class='op'>=</span> <span class='id identifier rubyid_sequence'>sequence</span><span class='period'>.</span><span class='id identifier rubyid_enum_for'>enum_for</span><span class='lparen'>(</span><span class='symbol'>:scan</span><span class='comma'>,</span> <span class='id identifier rubyid_re_motif_reverse'>re_motif_reverse</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_last_match'>last_match</span><span class='period'>.</span><span class='id identifier rubyid_begin'>begin</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span> <span class='rbrace'>}</span>

                <span class='comment'># we get the gene coordinates of the motif 
</span>                <span class='id identifier rubyid_b'>b</span> <span class='op'>=</span> <span class='id identifier rubyid_generate_complete_position_list'><span class='object_link'><a href="#generate_complete_position_list-instance_method" title="#generate_complete_position_list (method)">generate_complete_position_list</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_sites'>sites</span><span class='comma'>,</span> <span class='id identifier rubyid_match_pos_exon'>match_pos_exon</span><span class='rparen'>)</span>

            <span class='kw'>end</span>
            
        <span class='kw'>end</span>

        <span class='id identifier rubyid_forward_positions'>forward_positions</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_a'>a</span>
        <span class='id identifier rubyid_reverse_positions'>reverse_positions</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_b'>b</span>

    <span class='kw'>end</span>

    <span class='comment'># uniq -&gt; for getting rid of duplicate coordinates (corresponding different transcripts)
</span>    <span class='kw'>return</span> <span class='lbracket'>[</span><span class='id identifier rubyid_forward_positions'>forward_positions</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span><span class='period'>.</span><span class='id identifier rubyid_compact'>compact</span><span class='comma'>,</span> <span class='id identifier rubyid_reverse_positions'>reverse_positions</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span><span class='period'>.</span><span class='id identifier rubyid_compact'>compact</span><span class='rbracket'>]</span>

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="help-instance_method">
  
    #<strong>help</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>This function print a help message if needed.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '.\Functions.rb', line 2</span>

<span class='kw'>def</span> <span class='id identifier rubyid_help'>help</span>

    <span class='kw'>if</span> <span class='const'>ARGV</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-h</span><span class='tstring_end'>&quot;</span></span> <span class='op'>||</span> <span class='const'>ARGV</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-help</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_abort'>abort</span><span class='lparen'>(</span>
            <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n\t\tThis script gets the .embl file from all the genes present in the given list
            and searches from CTTCTT motif in their exons sequence, both the strands + and -. 
            It generates 3 files, gene_coordinates.gff3, chr_coordinates.gff3 and No_CTTCTT_report.txt.
            The first one contains the coordinates of CTTCTT motif using as reference the gene
            coordinates and the second one contains the same but using the chromosome coordinates.
            The third one is a report of all the genes that do not have CTTCTT motif.  
            --------------------------------------------------------------------
                USAGE
                ruby ./main genes_list_file
            --------------------------------------------------------------------\n</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="write_to_GFF3-instance_method">
  
    #<strong>write_to_GFF3</strong>(first_entry, entry, gene_name)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>This function writes the features in the gff3 files</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>first_entry</span>
      
      
        <span class='type'>(<tt>Bio::EMBL</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>embl information</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>entry</span>
      
      
        <span class='type'>(<tt>Bio::Sequence</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>sequence</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>gene_name</span>
      
      
        <span class='type'>(<tt>string</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>gene name</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '.\Functions.rb', line 178</span>

<span class='kw'>def</span> <span class='id identifier rubyid_write_to_GFF3'>write_to_GFF3</span><span class='lparen'>(</span><span class='id identifier rubyid_first_entry'>first_entry</span><span class='comma'>,</span> <span class='id identifier rubyid_entry'>entry</span><span class='comma'>,</span> <span class='id identifier rubyid_gene_name'>gene_name</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_gff'>gff</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_gff2'>gff2</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>

    <span class='id identifier rubyid_entry'>entry</span><span class='period'>.</span><span class='id identifier rubyid_features'>features</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_feature'>feature</span><span class='op'>|</span>

        <span class='kw'>if</span> <span class='id identifier rubyid_feature'>feature</span><span class='period'>.</span><span class='id identifier rubyid_feature'>feature</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>motif</span><span class='tstring_end'>&quot;</span></span>

            <span class='id identifier rubyid_matches'>matches</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

            <span class='id identifier rubyid_strand'>strand</span> <span class='op'>=</span> <span class='id identifier rubyid_feature'>feature</span><span class='period'>.</span><span class='id identifier rubyid_assoc'>assoc</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>strand</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>

            <span class='comment'>#we get the gene positions of the motif
</span>            <span class='id identifier rubyid_re'>re</span> <span class='op'>=</span> <span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^(\d+)\.\.(\d+)</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span>
            <span class='id identifier rubyid_positions'>positions</span> <span class='op'>=</span> <span class='id identifier rubyid_feature'>feature</span><span class='period'>.</span><span class='id identifier rubyid_position'>position</span>
            <span class='id identifier rubyid_match'>match</span> <span class='op'>=</span> <span class='id identifier rubyid_positions'>positions</span><span class='period'>.</span><span class='id identifier rubyid_match'>match</span><span class='lparen'>(</span><span class='id identifier rubyid_re'>re</span><span class='rparen'>)</span>

            <span class='comment'>#gene cordinates
</span>            <span class='id identifier rubyid_gff'>gff</span> <span class='op'>=</span> <span class='id identifier rubyid_gff'>gff</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gene_name'>gene_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>\t.\t.\t</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_match'>match</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='embexpr_end'>}</span><span class='tstring_content'>\t</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_match'>match</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='embexpr_end'>}</span><span class='tstring_content'>\t.\t</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_strand'>strand</span><span class='embexpr_end'>}</span><span class='tstring_content'>\t.\tnote=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gene_name'>gene_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>

            <span class='comment'>#we get the chromosome positions of the motif
</span>            <span class='id identifier rubyid_re'>re</span> <span class='op'>=</span> <span class='const'>Regexp</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\:(\d)\:(\d+)\:(\d+)</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span>
            <span class='id identifier rubyid_match2'>match2</span> <span class='op'>=</span> <span class='id identifier rubyid_first_entry'>first_entry</span><span class='period'>.</span><span class='id identifier rubyid_accession'>accession</span><span class='period'>.</span><span class='id identifier rubyid_match'>match</span><span class='lparen'>(</span><span class='id identifier rubyid_re'>re</span><span class='rparen'>)</span>

            <span class='comment'>#chromosome coordinates
</span>            <span class='id identifier rubyid_gff2'>gff2</span> <span class='op'>=</span> <span class='id identifier rubyid_gff2'>gff2</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>chr</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_match2'>match2</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>\t.\t.\t</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_match'>match</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='op'>+</span><span class='id identifier rubyid_match2'>match2</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='op'>-</span><span class='int'>1</span><span class='embexpr_end'>}</span><span class='tstring_content'>\t</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_match'>match</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='op'>+</span><span class='id identifier rubyid_match2'>match2</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='op'>-</span><span class='int'>1</span><span class='embexpr_end'>}</span><span class='tstring_content'>\t.\t</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_strand'>strand</span><span class='embexpr_end'>}</span><span class='tstring_content'>\t.\tnote=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_gene_name'>gene_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>
        
        <span class='kw'>end</span>

    <span class='kw'>end</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_gff'>gff</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>

        <span class='kw'>return</span> <span class='kw'>nil</span>

    <span class='kw'>else</span>

        <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>gene_coordinates.gff3</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>a</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_file'>file</span><span class='op'>|</span>
            <span class='id identifier rubyid_file'>file</span><span class='period'>.</span><span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_gff'>gff</span> <span class='kw'>unless</span> <span class='id identifier rubyid_gff'>gff</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
        <span class='kw'>end</span>
    
        <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>chromosome_coordinates.gff3</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>a</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_file'>file</span><span class='op'>|</span>
            <span class='id identifier rubyid_file'>file</span><span class='period'>.</span><span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_gff2'>gff2</span> <span class='kw'>unless</span> <span class='id identifier rubyid_gff2'>gff2</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
        <span class='kw'>end</span>
        
    <span class='kw'>end</span>

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Mon Nov 29 20:32:57 2021 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.26 (ruby-3.0.2).
</div>

    </div>
  </body>
</html>